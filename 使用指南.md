# Free Games Claimer ä½¿ç”¨æŒ‡å—

## ğŸ“¦ å®‰è£…å®Œæˆ

é¡¹ç›®å·²ç»æˆåŠŸå®‰è£…åˆ°ï¼š`/Users/zhengdongxu/Projects/free-games-claimer`

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. åŸºæœ¬ä½¿ç”¨

#### Epic Games Storeï¼ˆEpic æ¸¸æˆå•†åº—ï¼‰
```bash
cd /Users/zhengdongxu/Projects/free-games-claimer
node epic-games
```

#### Amazon Prime Gamingï¼ˆäºšé©¬é€Š Prime æ¸¸æˆï¼‰
```bash
node prime-gaming
```

#### GOG æ¸¸æˆå•†åº—
```bash
node gog
```

#### è¿è¡Œæ‰€æœ‰å¹³å°
```bash
node epic-games && node prime-gaming && node gog
```

### 2. é¦–æ¬¡è¿è¡Œ

ç¬¬ä¸€æ¬¡è¿è¡Œæ—¶ï¼Œè„šæœ¬ä¼šï¼š
1. è‡ªåŠ¨æ‰“å¼€ Firefox æµè§ˆå™¨ï¼ˆé»˜è®¤éšè—ï¼Œåå°è¿è¡Œï¼‰
2. æç¤ºä½ ç™»å½•è´¦å·
3. ä½ å¯ä»¥é€‰æ‹©ï¼š
   - **æ–¹å¼ä¸€**ï¼šåœ¨ç»ˆç«¯è¾“å…¥é‚®ç®±å’Œå¯†ç ï¼ˆå¦‚æœå¯ç”¨äº† 2FAï¼Œè¿˜éœ€è¦è¾“å…¥éªŒè¯ç ï¼‰
   - **æ–¹å¼äºŒ**ï¼šæŒ‰ `ESC` è·³è¿‡æç¤ºï¼Œç›´æ¥åœ¨æµè§ˆå™¨ä¸­æ‰‹åŠ¨ç™»å½•

ç™»å½•æˆåŠŸåï¼Œè„šæœ¬ä¼šè‡ªåŠ¨é¢†å–å½“å‰å¯ç”¨çš„å…è´¹æ¸¸æˆã€‚

### 3. æ˜¾ç¤ºæµè§ˆå™¨ç•Œé¢ï¼ˆè°ƒè¯•ç”¨ï¼‰

å¦‚æœä½ æƒ³çœ‹åˆ°æµè§ˆå™¨æ“ä½œè¿‡ç¨‹ï¼Œå¯ä»¥è®¾ç½® `SHOW=1`ï¼š

```bash
SHOW=1 node epic-games
```

## âš™ï¸ é…ç½®é€‰é¡¹

### ç¯å¢ƒå˜é‡é…ç½®

ä½ å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æ¥é…ç½®è„šæœ¬ï¼Œé¿å…æ¯æ¬¡éƒ½è¦è¾“å…¥è´¦å·ä¿¡æ¯ï¼š

#### æ–¹å¼ä¸€ï¼šå‘½ä»¤è¡Œç›´æ¥è®¾ç½®ï¼ˆæ¨èç”¨äºæµ‹è¯•ï¼‰

```bash
# Epic Games
EG_EMAIL=your@email.com EG_PASSWORD=yourpassword SHOW=1 node epic-games

# Prime Gaming
PG_EMAIL=your@email.com PG_PASSWORD=yourpassword node prime-gaming

# GOG
GOG_EMAIL=your@email.com GOG_PASSWORD=yourpassword node gog
```

#### æ–¹å¼äºŒï¼šåˆ›å»ºé…ç½®æ–‡ä»¶ï¼ˆæ¨èç”¨äºé•¿æœŸä½¿ç”¨ï¼‰

åˆ›å»º `data/config.env` æ–‡ä»¶ï¼š

```bash
cd /Users/zhengdongxu/Projects/free-games-claimer
mkdir -p data
```

ç¼–è¾‘ `data/config.env` æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š

```env
# é€šç”¨é‚®ç®±å’Œå¯†ç ï¼ˆä¼šè¢«å¹³å°ç‰¹å®šçš„è¦†ç›–ï¼‰
EMAIL=your@email.com
PASSWORD=yourpassword

# Epic Games é…ç½®
EG_EMAIL=your@email.com
EG_PASSWORD=yourpassword
EG_OTPKEY=your_otp_key_if_2fa_enabled

# Prime Gaming é…ç½®
PG_EMAIL=your@email.com
PG_PASSWORD=yourpassword
PG_OTPKEY=your_otp_key_if_2fa_enabled

# GOG é…ç½®
GOG_EMAIL=your@email.com
GOG_PASSWORD=yourpassword

# é€šçŸ¥é…ç½®ï¼ˆå¯é€‰ï¼‰
# NOTIFY=tgram://bottoken/ChatID  # Telegram é€šçŸ¥
# NOTIFY=mailto://email:password@gmail.com  # é‚®ä»¶é€šçŸ¥
```

### å¸¸ç”¨é…ç½®é€‰é¡¹

| é€‰é¡¹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|--------|------|
| `SHOW` | `1` (Docker) / éšè— (æœ¬åœ°) | æ˜¯å¦æ˜¾ç¤ºæµè§ˆå™¨ç•Œé¢ |
| `WIDTH` | `1280` | æµè§ˆå™¨å®½åº¦ |
| `HEIGHT` | `1280` | æµè§ˆå™¨é«˜åº¦ |
| `TIMEOUT` | `60` | é¡µé¢æ“ä½œè¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |
| `LOGIN_TIMEOUT` | `180` | ç™»å½•è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼‰ |

## ğŸ” åŒå› ç´ è®¤è¯ï¼ˆ2FAï¼‰è®¾ç½®

å¦‚æœä½ å¯ç”¨äº† 2FAï¼Œéœ€è¦è·å– OTP Keyï¼š

### Epic Games
1. è®¿é—® [å¯†ç å’Œå®‰å…¨è®¾ç½®](https://www.epicgames.com/account/password)
2. å¯ç”¨"ç¬¬ä¸‰æ–¹éªŒè¯å™¨åº”ç”¨"
3. å¤åˆ¶"æ‰‹åŠ¨è¾“å…¥å¯†é’¥"
4. åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½® `EG_OTPKEY=ä½ çš„å¯†é’¥`

### Prime Gaming
1. è®¿é—® Amazon "ä½ çš„è´¦æˆ· â€º ç™»å½•å’Œå®‰å…¨"
2. è¿›å…¥"ä¸¤æ­¥éªŒè¯" â€º ç®¡ç† â€º æ·»åŠ æ–°åº”ç”¨
3. é€‰æ‹©"æ— æ³•æ‰«ææ¡å½¢ç "
4. å¤åˆ¶ç²—ä½“æ˜¾ç¤ºçš„å¯†é’¥
5. åœ¨é…ç½®æ–‡ä»¶ä¸­è®¾ç½® `PG_OTPKEY=ä½ çš„å¯†é’¥`

### GOG
GOG åªæ”¯æŒé€šè¿‡é‚®ä»¶å‘é€éªŒè¯ç ï¼Œæ— æ³•ä½¿ç”¨ OTP Keyã€‚

## ğŸ“… å®šæ—¶è¿è¡Œï¼ˆå·²é…ç½®ï¼‰

å½“å‰å·²é…ç½® macOS launchd å®šæ—¶ä»»åŠ¡ï¼Œæ¯å¤©ä¸Šåˆ 11:00 è‡ªåŠ¨è¿è¡Œé¢†å– Epic Games å…è´¹æ¸¸æˆã€‚

### å½“å‰å®šæ—¶ä»»åŠ¡

é…ç½®æ–‡ä»¶ä½äº `~/Library/LaunchAgents/com.fgc.epic-games.plist`ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

```xml
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
    <key>Label</key>
    <string>com.fgc.epic-games</string>
    <key>ProgramArguments</key>
    <array>
        <string>/Users/dxzheng/.nvm/versions/node/v18.20.8/bin/node</string>
        <string>/Users/zhengdongxu/Projects/free-games-claimer/epic-games.js</string>
    </array>
    <key>WorkingDirectory</key>
    <string>/Users/zhengdongxu/Projects/free-games-claimer</string>
    <key>StartCalendarInterval</key>
    <dict>
        <key>Hour</key>
        <integer>11</integer>
        <key>Minute</key>
        <integer>0</integer>
    </dict>
    <key>StandardOutPath</key>
    <string>/Users/zhengdongxu/Projects/free-games-claimer/data/logs/epic-games.log</string>
    <key>StandardErrorPath</key>
    <string>/Users/zhengdongxu/Projects/free-games-claimer/data/logs/epic-games.err</string>
    <key>EnvironmentVariables</key>
    <dict>
        <key>PATH</key>
        <string>/Users/dxzheng/.nvm/versions/node/v18.20.8/bin:/usr/local/bin:/usr/bin:/bin</string>
        <key>SHOW</key>
        <string>1</string>
    </dict>
</dict>
</plist>
```

### ç®¡ç†å®šæ—¶ä»»åŠ¡

```bash
# æŸ¥çœ‹ä»»åŠ¡çŠ¶æ€
launchctl list | grep fgc

# æ‰‹åŠ¨è§¦å‘ä¸€æ¬¡ï¼ˆæµ‹è¯•ç”¨ï¼‰
launchctl start com.fgc.epic-games

# åœç”¨å®šæ—¶ä»»åŠ¡
launchctl unload ~/Library/LaunchAgents/com.fgc.epic-games.plist

# é‡æ–°å¯ç”¨å®šæ—¶ä»»åŠ¡
launchctl load ~/Library/LaunchAgents/com.fgc.epic-games.plist
```

### æŸ¥çœ‹è¿è¡Œæ—¥å¿—

```bash
# æŸ¥çœ‹æ ‡å‡†è¾“å‡º
cat /Users/zhengdongxu/Projects/free-games-claimer/data/logs/epic-games.log

# æŸ¥çœ‹é”™è¯¯è¾“å‡º
cat /Users/zhengdongxu/Projects/free-games-claimer/data/logs/epic-games.err

# å®æ—¶è·Ÿè¸ªæ—¥å¿—
tail -f /Users/zhengdongxu/Projects/free-games-claimer/data/logs/epic-games.log
```

### ä¿®æ”¹è¿è¡Œæ—¶é—´

ç¼–è¾‘ `~/Library/LaunchAgents/com.fgc.epic-games.plist`ï¼Œä¿®æ”¹ `Hour` å’Œ `Minute` çš„å€¼ï¼Œç„¶åé‡æ–°åŠ è½½ï¼š

```bash
launchctl unload ~/Library/LaunchAgents/com.fgc.epic-games.plist
launchctl load ~/Library/LaunchAgents/com.fgc.epic-games.plist
```

### è¡¥å……è¯´æ˜

- å®šæ—¶ä»»åŠ¡åœ¨åå°é™é»˜è¿è¡Œï¼ˆä¸æ˜¾ç¤ºæµè§ˆå™¨çª—å£ï¼‰
- å¦‚æœç”µè„‘åœ¨ 11:00 å¤„äºç¡çœ çŠ¶æ€ï¼ŒmacOS ä¼šåœ¨å”¤é†’åè‡ªåŠ¨è¡¥è·‘
- è„šæœ¬ä¼šè‡ªåŠ¨è·³è¿‡å·²é¢†å–çš„æ¸¸æˆï¼Œæ¯å¤©è¿è¡Œä¸€æ¬¡å³å¯
- å¦‚éœ€æ·»åŠ  Prime Gaming æˆ– GOG çš„å®šæ—¶ä»»åŠ¡ï¼Œå¯å¤åˆ¶æ­¤é…ç½®æ–‡ä»¶å¹¶ä¿®æ”¹è„šæœ¬è·¯å¾„

### å…¶ä»–å¹³å°å®šæ—¶æ–¹å¼

#### Linux ä½¿ç”¨ crontab

```bash
crontab -e
# æ·»åŠ ï¼šæ¯å¤© 11 ç‚¹è¿è¡Œ
0 11 * * * cd /path/to/free-games-claimer && node epic-games
```

#### Windows ä½¿ç”¨ä»»åŠ¡è®¡åˆ’ç¨‹åº

åœ¨"ä»»åŠ¡è®¡åˆ’ç¨‹åº"ä¸­åˆ›å»ºåŸºæœ¬ä»»åŠ¡ï¼Œè®¾ç½®æ¯å¤©è§¦å‘ï¼Œæ“ä½œä¸ºè¿è¡Œ `node epic-games`ã€‚

## ğŸ”” é€šçŸ¥è®¾ç½®

### é£ä¹¦é€šçŸ¥ï¼ˆå·²é…ç½®ï¼‰

å·²é…ç½®é£ä¹¦æœºå™¨äºº webhook é€šçŸ¥ã€‚é¢†å–æ¸¸æˆæˆåŠŸæˆ–å¤±è´¥æ—¶ä¼šè‡ªåŠ¨å‘é€é£ä¹¦æ¶ˆæ¯ã€‚

é…ç½®åœ¨ `data/config.env` ä¸­ï¼š
```env
FEISHU_WEBHOOK=https://open.feishu.cn/open-apis/bot/v2/hook/72b5db9e-0020-43df-856b-f05e1316fdff
```

å¦‚éœ€æ›´æ¢é£ä¹¦ç¾¤/æœºå™¨äººï¼Œä¿®æ”¹ä¸Šé¢çš„ webhook åœ°å€å³å¯ã€‚

### å…¶ä»–é€šçŸ¥æ–¹å¼ï¼ˆå¯é€‰ï¼‰

é¡¹ç›®è¿˜æ”¯æŒé€šè¿‡ [Apprise](https://github.com/caronc/apprise) å‘é€å…¶ä»–å¹³å°é€šçŸ¥ï¼ˆéœ€ `pip install apprise`ï¼‰ï¼š

```env
# Telegram
NOTIFY=tgram://BOT_TOKEN/CHAT_ID

# é‚®ä»¶
NOTIFY=mailto://your_email:your_password@gmail.com
```

## ğŸ“Š è¿è¡Œé¢‘ç‡å»ºè®®

- **Epic Games**ï¼šæ¯å‘¨é€šå¸¸æœ‰ 2 ä¸ªå…è´¹æ¸¸æˆï¼Œåœ£è¯èŠ‚å‰æ¯å¤©éƒ½æœ‰
- **Prime Gaming**ï¼šæ¯æœˆæˆ– Prime Day æœŸé—´æ›´é¢‘ç¹
- **GOG**ï¼šé€šå¸¸æ¯å‡ å‘¨æœ‰ä¸€ä¸ªæ–°æ¸¸æˆ

**å»ºè®®æ¯å¤©è¿è¡Œä¸€æ¬¡**ï¼Œè„šæœ¬ä¼šè‡ªåŠ¨è·³è¿‡å·²é¢†å–çš„æ¸¸æˆã€‚

## ğŸ› å¸¸è§é—®é¢˜

### 1. Cloudflare éªŒè¯æ‹¦æˆªï¼ˆå·²è§£å†³ï¼‰

åŸå§‹é¡¹ç›®ä½¿ç”¨ Playwright çš„ç‰¹æ®Šç‰ˆ Firefoxï¼Œä¼šè¢« Cloudflare åæœºå™¨äººæ£€æµ‹æ‹¦æˆªï¼Œé¡µé¢æ˜¾ç¤º `error.500.title`ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼šå·²å°† `epic-games.js` ä¸­çš„ `playwright-firefox` æ›¿æ¢ä¸º `patchright`ï¼ˆåæ£€æµ‹ç‰ˆ Playwrightï¼‰ï¼Œä½¿ç”¨ç³»ç»Ÿå®‰è£…çš„çœŸå® Chrome æµè§ˆå™¨ï¼Œå¯æ­£å¸¸é€šè¿‡ Cloudflare éªŒè¯ã€‚

ç›¸å…³ Issueï¼š[#183](https://github.com/vogler/free-games-claimer/issues/183)ã€[#483](https://github.com/vogler/free-games-claimer/issues/483)

### 2. é¡µé¢åŠ è½½è¶…æ—¶

Epic å•†åº—é¡µé¢è¾ƒé‡ï¼Œå¯èƒ½å¯¼è‡´åŠ è½½è¶…æ—¶ã€‚å·²å°† `page.goto` å’Œ `waitForURL` æ”¹ä¸º `domcontentloaded` æ¨¡å¼ï¼ˆä¸ç­‰å¾…å›¾ç‰‡ç­‰èµ„æºåŠ è½½å®Œæ¯•ï¼‰ï¼ŒåŠ å¿«è¿è¡Œé€Ÿåº¦ã€‚

### 3. å·²æœ‰ Firefox è¿›ç¨‹å†²çª

å¦‚æœè¿è¡Œæ—¶æŠ¥é”™ `Target page, context or browser has been closed`ï¼Œå¯èƒ½æ˜¯æœ‰æ®‹ç•™çš„ Firefox è¿›ç¨‹å ç”¨äº†æµè§ˆå™¨é…ç½®ç›®å½•ï¼š
```bash
pkill -f firefox
```

### 4. è°ƒè¯•æ¨¡å¼

å¦‚æœæƒ³è°ƒè¯•è„šæœ¬è¿è¡Œè¿‡ç¨‹ï¼š
```bash
SHOW=1 node epic-games  # æ˜¾ç¤ºæµè§ˆå™¨çª—å£
PWDEBUG=1 node epic-games  # å¼€å¯ Playwright è°ƒè¯•å™¨
```

### 5. æŸ¥çœ‹å·²é¢†å–çš„æ¸¸æˆ

å·²é¢†å–çš„æ¸¸æˆè®°å½•ä¿å­˜åœ¨ï¼š
- `data/epic-games.json`
- `data/prime-gaming.json`
- `data/gog.json`

### 6. æˆªå›¾ä¿å­˜ä½ç½®

è„šæœ¬è¿è¡Œæ—¶çš„æˆªå›¾ä¿å­˜åœ¨ `data/screenshots/` ç›®å½•ã€‚

## ğŸ”„ æ›´æ–°é¡¹ç›®

> æ³¨æ„ï¼šæ›´æ–°åéœ€è¦æ£€æŸ¥ `epic-games.js` ä¸­çš„ patchright æ”¹åŠ¨æ˜¯å¦è¢«è¦†ç›–

```bash
cd /Users/zhengdongxu/Projects/free-games-claimer
git stash        # æš‚å­˜æœ¬åœ°ä¿®æ”¹
git pull          # æ‹‰å–æ›´æ–°
git stash pop     # æ¢å¤æœ¬åœ°ä¿®æ”¹ï¼ˆå¯èƒ½éœ€è¦æ‰‹åŠ¨è§£å†³å†²çªï¼‰
npm install
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å®‰å…¨æé†’**ï¼šé…ç½®æ–‡ä»¶ä¸­çš„å¯†ç å’Œ OTP Key æ˜¯æ˜æ–‡å­˜å‚¨çš„ï¼Œè¯·ç¡®ä¿æ–‡ä»¶æƒé™å®‰å…¨ï¼š
   ```bash
   chmod 600 data/config.env
   ```

2. **è´¦å·å®‰å…¨**ï¼šå»ºè®®ä½¿ç”¨å¼ºå¯†ç ï¼Œå¹¶è€ƒè™‘ä½¿ç”¨ä¸“é—¨çš„è´¦å·å¯†ç ã€‚

3. **Docker æ¨¡å¼**ï¼šå¦‚æœæƒ³ä½¿ç”¨ Docker è¿è¡Œï¼Œå¯ä»¥å‚è€ƒé¡¹ç›® README.md ä¸­çš„ Docker éƒ¨åˆ†ã€‚

## ğŸ“š æ›´å¤šä¿¡æ¯

- é¡¹ç›®åœ°å€ï¼šhttps://github.com/vogler/free-games-claimer
- é—®é¢˜åé¦ˆï¼šhttps://github.com/vogler/free-games-claimer/issues

---

**ç¥ä½ æ¸¸æˆæ„‰å¿«ï¼ğŸ®**
